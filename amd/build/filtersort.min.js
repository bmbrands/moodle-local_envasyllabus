define("local_envasyllabus/filtersort",["exports","core/config","jquery"],(function(_exports,_config,_jquery){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Javascript to initialise the enva filter sorting.
   *
   * @package    local_envasyllabus
   * @copyright  2022 CALL Learning <laurent@call-learning.fr>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_config=_interopRequireDefault(_config),_jquery=_interopRequireDefault(_jquery);_exports.init=function(filterItemId){var formNode=document.querySelector("#"+filterItemId+" form");formNode.addEventListener("submit",(function(e){e.preventDefault();var filterinfo=getFilterData(formNode,!1);if(filterinfo){var event=new CustomEvent("enva-syllabus-catalog-filter",{detail:filterinfo});document.dispatchEvent(event)}}))};var getFilterData=function(target,ignoresesskey){var data=(0,_jquery.default)(target).serializeArray(),sesskeyconfirmed=!1,returnedFilter={},filterarray=[],sortcriteria={};data.forEach((function(d){if("sesskey"===d.name)sesskeyconfirmed=d.value===_config.default.sesskey;else if(d.value){var filtername=d.name.match(/^filter_([^\[]+)[\[\]]*/);if(filtername&&"_qf__force_multiselect_submission"!==d.value){var filtertype="customfield";filtername[1].includes("_ftext_")&&(filtertype="fulltext"),filterarray.push({type:filtertype,search:{field:filtername[1],value:d.value}})}}}));var sortfield=data.find((function(d){return"sort"===d.name}));if(sortfield&&sortfield.value){var sortfieldspec=sortfield.value.match(/^(.+)-(.+)/);sortfieldspec&&(sortcriteria={order:sortfieldspec[2],field:sortfieldspec[1]})}return sesskeyconfirmed||ignoresesskey?(filterarray&&(returnedFilter.filters=filterarray),sortcriteria&&(returnedFilter.sort=sortcriteria),returnedFilter):null}}));

//# sourceMappingURL=filtersort.min.js.map